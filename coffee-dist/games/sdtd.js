// Generated by CoffeeScript 2.4.1
(function() {
  var GenericServer, SdtdServer, execSync;

  GenericServer = require("./generic");

  ({execSync} = require("child_process"));

  SdtdServer = class SdtdServer extends GenericServer {
    static install(flags) {
      var install_cmd, steamLogin;
      super.install(flags);
      steamLogin = `+login ${flags.config.steamUserName} ${flags.config.steamPassword}`;
      install_cmd = `steamcmd ${steamLogin} +force_install_dir ${flags.path} +app_update ${flags.config.appId} validate +quit`;
      if (flags.dryrun !== true) {
        execSync(install_cmd);
      }
      this.createUnitFile(flags);
      this.createLaunchScript(flags);
      return this.createLogFile(flags);
    }

    static createUnitFile(flags) {
      return super.createUnitFile(flags);
    }

    static createLaunchScript(flags) {
      var launchFileContents;
      //# Because of the export LD_LIBRARY_PATH bullshit, this is way more work than it looks
      launchFileContents = `export LD_LIBRARY_PATH=.\n${flags.path}/7DaysToDieServer.x86_64 -logfile ${flags.path}/console.log -quit -batchmode -nographics -dedicated -configfile=${flags.path}/serverconfig.xml & /usr/bin/tail -f ${flags.path}/console.log`;
      return super.createLaunchScript(flags, launchFileContents);
    }

    static createLogFile(flags) {
      return execSync(`touch ${flags.path}/console.log`);
    }

    static backupFile(file) {
      execSync(`touch ${file}`);
      execSync(`rm -f ${file}.backup`);
      return execSync(`mv ${file} ${file}.backup`);
    }

  };

  module.exports = SdtdServer;

}).call(this);

//# sourceMappingURL=sdtd.js.map
